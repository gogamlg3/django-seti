{% extends 'base.html' %}
{% load static %}
{% block title %}{{ topic.title }}{% endblock %}
{% block content %}
  <style>
      .text-section img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 1rem auto;
      }
  </style>
  <h2>{{ topic.title }}</h2>
  <div class="topic-content">
    <div class="text-section">
      {{ topic.content|safe }}
    </div>
    {% if topic.video_url %}
      <div class="video-section">
        <video width="100%" controls>
          <source src="{% static topic.video_url %}" type="video/mp4">
          Ваш браузер не поддерживает видео.
        </video>
      </div>
    {% endif %}
  </div>

  <hr>
  <h3>Тест</h3>
  {% if completed %}
    <p>Ваш результат: {{ score }} / {{ questions|length }}</p>
  {% else %}
    <form method="post">
      {% csrf_token %}
      {% for question in questions %}
        <div class="question">
          <p>{{ forloop.counter }}. {{ question.text }}</p>
          {% for choice in question.choices.all %}
            <label>
              <input type="radio" name="{{ question.id }}" value="{{ choice.id }}"> {{ choice.text }}
            </label><br>
          {% endfor %}
        </div>
      {% endfor %}
      <button type="submit" class="btn">Отправить ответы</button>
    </form>
  {% endif %}
{% endblock %}